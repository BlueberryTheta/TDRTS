<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>TDRTS â€“ WW2 CTF (Prototype)</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' fill='%232f3a2e'/%3E%3Cpath d='M6 8h14l6 4-6 4H6z' fill='%23b08d57'/%3E%3Crect x='8' y='10' width='8' height='6' fill='%23c2b280'/%3E%3C/svg%3E" />
  </head>
  <body>
    <div id="app">
      <div id="hudTop" class="panel" aria-label="Top HUD">
        <div class="hud-item"><span class="hud-label">Player</span> <span class="hud-pill" id="currentPlayerTop">1</span></div>
        <div class="hud-item"><span class="hud-label">Money</span> <span class="hud-pill" id="moneyTop">0</span></div>
        <div class="hud-item"><span class="hud-label">Turn</span> <span class="hud-pill" id="turnTop">1</span></div>
        <div class="hud-spacer"></div>
        <button id="endTurnTop" class="hud-button">End Turn</button>
      </div>
      <div id="roomBanner" class="banner" style="display:none">
        <div class="banner-left">
          <span class="hud-label">Room</span>
          <span id="roomCode" class="hud-pill">-</span>
          <span class="hud-label" style="margin-left:10px">You</span>
          <span id="playerLabel" class="hud-pill">P1</span>
          <span class="hud-label" style="margin-left:10px">Opponent</span>
          <span id="opponentStatus" class="hud-pill">Waiting</span>
        </div>
        <div class="hud-spacer"></div>
        <button id="mpMenuBtn" class="hud-button" title="Game menu">Menu</button>
        <button id="copyLinkBtn" class="hud-button" title="Copy invite link">Copy Link</button>
      </div>
      <div id="left">
        <canvas id="gameCanvas" width="640" height="640"></canvas>
        <details id="mpLogPanel" class="panel accordion" style="margin-top:8px">
          <summary>Game Log</summary>
          <div id="mpLogList" class="log-list"></div>
        </details>
      </div>
      <div id="right">
        <div id="status">
          <div>Current Player: <span id="currentPlayer">1</span></div>
          <div>Money: $<span id="money">0</span></div>
          <div>Turn: <span id="turn">1</span></div>
        </div>
        <hr />
        <div id="shop" class="panel">
          <h2 style="margin-top:0">Requisitions</h2>
          <div class="shop-section-title">Units</div>
          <div class="shop-grid">
            <button class="shop-item" data-unit="Infantry"><span class="thumb"></span><span class="label">Infantry</span><span class="price">$50</span></button>
            <button class="shop-item" data-unit="Tank"><span class="thumb"></span><span class="label">Tank</span><span class="price">$100</span></button>
            <button class="shop-item" data-unit="Artillery"><span class="thumb"></span><span class="label">Artillery</span><span class="price">$120</span></button>
            <button class="shop-item" data-unit="Engineer"><span class="thumb"></span><span class="label">Engineer</span><span class="price">$60</span></button>
            <button class="shop-item" data-unit="Officer"><span class="thumb"></span><span class="label">Officer</span><span class="price">$80</span></button>
            <button class="shop-item" data-unit="Medic"><span class="thumb"></span><span class="label">Medic</span><span class="price">$70</span></button>
            <button class="shop-item" data-unit="Scout"><span class="thumb"></span><span class="label">Scout</span><span class="price">$60</span></button>
            <button class="shop-item" data-unit="MechanizedInfantry"><span class="thumb"></span><span class="label">Mechanized Infantry</span><span class="price">$120</span></button>
          </div>
          <div class="shop-section-title" style="margin-top:10px">Fortifications</div>
          <div class="shop-grid">
            <button class="shop-item" data-fort="Pillbox"><span class="thumb"></span><span class="label">Pillbox</span><span class="price">$80</span></button>
            <button class="shop-item" data-fort="Bunker"><span class="thumb"></span><span class="label">Bunker</span><span class="price">$120</span></button>
            <button class="shop-item" data-fort="BarbedWire"><span class="thumb"></span><span class="label">Barbed Wire</span><span class="price">$30</span></button>
            <button class="shop-item" data-fort="SupplyDepot"><span class="thumb"></span><span class="label">Supply Depot</span><span class="price">$150</span></button>
          </div>
          <div class="hint">Buy and place near base, or Engineers can build adjacent.</div>
          <div class="stat-row" style="margin-top:8px; justify-content:space-between; align-items:center">
            <label for="shopInfoToggle" class="hint">Show info on click</label>
            <input id="shopInfoToggle" type="checkbox" checked />
          </div>
        </div>
        <hr />
        <div id="actions" class="panel">
          <h2>Actions</h2>
          <button id="endTurn">End Turn</button>
          <div class="hint">Select a unit to move/attack. Click an enemy to attack if in range.</div>
        </div>
        <hr />
        <div id="unitPanel" class="panel">
          <h2 style="margin-top:0">Selected Unit</h2>
          <div id="unitNone" class="hint">No unit selected.</div>
          <div id="unitInfo" style="display:none">
            <div class="stat-row"><strong id="unitName"></strong> <span id="unitOwner" class="hint"></span> <span id="unitRankBadge" class="badge" style="margin-left:auto">Private</span></div>
            <div class="stat-row"><span style="width:40px">HP</span><div id="unitHpBar" class="bar"><div class="bar-fill" style="width:0%"></div></div><span id="unitHP" class="hint"></span></div>
            <details class="accordion">
              <summary>Details</summary>
              <div id="unitStats">ATK: -, DEF: -, MOVE: -, RNG: -, SIGHT: -</div>
              <div id="unitXP">XP: 0 (<span id="unitRank">Private</span>)</div>
              <div id="unitAbilities">Abilities: -</div>
            </details>
          </div>
        </div>
        <hr />
        <details id="legend" class="panel accordion">
          <summary>Legend</summary>
          <div class="legend-row"><span class="legend-swatch p1"></span> Player 1 Units</div>
          <div class="legend-row"><span class="legend-swatch p2"></span> Player 2 Units</div>
          <div class="legend-row"><span class="legend-swatch base"></span> Base (Flag starts here)</div>
          <div class="legend-row"><span class="legend-swatch flag"></span> Flag</div>
          <div class="legend-row"><span class="legend-swatch spawn"></span> Spawn Tiles</div>
          <div class="legend-row"><span class="legend-swatch fort"></span> Fortification</div>
          <div class="legend-row"><span class="legend-swatch move"></span> Move Range</div>
          <div class="legend-row"><span class="legend-swatch atk"></span> Attack Range</div>
        </details>
        <hr />
        <details id="help" class="panel accordion">
          <summary>How To Play</summary>
          <ul>
            <li>Two players take turns on the same device.</li>
            <li>Earn $10 each turn. Buy units and spawn near your base.</li>
            <li>Select your unit, click a highlighted tile to move.</li>
            <li>Click an enemy in range to attack.</li>
            <li>Capture the enemy flag by moving onto it, then bring it back to your base.</li>
          </ul>
        </details>
        <!-- Lightweight shop preview tooltip/modal -->
        <div id="shopPreview" class="shop-preview panel" style="display:none"></div>
      </div>
    </div>
    <!-- MP In-Game Menu Modal -->
    <div id="mpMenuModal" class="modal" style="display:none" role="dialog" aria-modal="true" aria-labelledby="mpMenuTitle">
      <div class="modal-content panel">
        <h2 id="mpMenuTitle" style="margin-top:0">Game Menu</h2>
        <p class="hint">Multiplayer options</p>
        <div style="display:flex; gap:10px; justify-content:center; margin-top:8px; flex-wrap:wrap">
          <button id="mpLeaveBtn" class="hud-button">Leave Room</button>
          <button id="mpMainBtn" class="hud-button">Main Menu</button>
          <button id="mpMenuCancelBtn" class="hud-button">Cancel</button>
        </div>
      </div>
    </div>
    <!-- Game Over Modal -->
    <div id="gameOverModal" class="modal" style="display:none" role="dialog" aria-modal="true" aria-labelledby="gameOverTitle">
      <div class="modal-content panel">
        <h2 id="gameOverTitle" style="margin-top:0">Game Over</h2>
        <p id="gameOverText">Player 1 captured the flag!</p>
        <div style="margin-top:10px">
          <button id="newGameBtn" class="hud-button">Start New Game</button>
        </div>
      </div>
    </div>
    <!-- Mode Selection Modal (Landing) -->
    <div id="modeModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modeTitle">
      <div class="modal-content panel">
        <h2 id="modeTitle" style="margin-top:0">Select Mode</h2>
        <p class="hint">Choose how you want to play.</p>
        <div style="display:flex; gap:10px; justify-content:center; margin-top:8px">
          <button id="playVsAi" class="hud-button">Play vs Computer</button>
          <button id="playOnline" class="hud-button">Play Online (Friend)</button>
        </div>
        <div id="aiControls" style="display:none; margin-top:12px">
          <div class="mp-grid">
            <div class="mp-card">
              <h3>Difficulty</h3>
              <div class="stat-row" style="flex-wrap:wrap; gap:6px">
                <button class="hud-button ai-diff" data-diff="easy">Easy</button>
                <button class="hud-button ai-diff" data-diff="medium">Medium</button>
                <button class="hud-button ai-diff" data-diff="hard">Hard</button>
              </div>
              <div class="hint">Choose how smart the computer plays.</div>
            </div>
            <div class="mp-card" style="display:flex; align-items:center; justify-content:center">
              <button id="startAiBtn" class="hud-button">Start Game</button>
            </div>
          </div>
        </div>
        <div id="mpControls" style="display:none; margin-top:12px">
          <div class="mp-grid">
            <div class="mp-card">
              <h3>Create Room</h3>
              <p class="hint">Generate a room and share the link.</p>
              <button id="createRoomBtn" class="hud-button">Create Room</button>
              <div id="createdRoom" style="display:none; margin-top:8px">
                <div class="hint">Room Code:</div>
                <div class="stat-row">
                  <span id="createdRoomCode" class="hud-pill">-</span>
                  <button id="copyLinkBtnModal" class="hud-button">Copy Link</button>
                </div>
              </div>
            </div>
            <div class="mp-card">
              <h3>Join Room</h3>
              <p class="hint">Enter a room code from your friend.</p>
              <div class="stat-row">
                <input id="joinCodeInput" class="input" placeholder="Enter Code" maxlength="12" />
                <button id="joinRoomBtn" class="hud-button">Join</button>
              </div>
              <div id="joinError" class="hint" style="color:#f85149; display:none;">Invalid code or room full.</div>
            </div>
          </div>
        </div>
        <details id="mpInfo" class="accordion" style="margin-top:10px">
          <summary>Online Multiplayer</summary>
          <p class="hint">Create or join a room to play with a friend. Copy and share the invite link.</p>
        </details>
      </div>
    </div>
    <script type="module" src="src/main.js"></script>
  </body>
  </html>


